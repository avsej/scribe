<?xml version="1.0"?>
<fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format" font-family="URW Bookman L,Symbol,ZapfDingbats" font-size="12pt" text-align="left" line-height="normal" font-selection-strategy="character-by-character" line-height-shift-adjustment="disregard-shifts" writing-mode="lr-tb" language="en"><fo:layout-master-set><fo:simple-page-master master-name="blank" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.5in" margin-right="0.75in"><fo:region-body display-align="center" margin-bottom="0.5in" margin-top="0.5in"/><fo:region-before region-name="xsl-region-before-blank" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-blank" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-first" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-odd" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-even" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.5in" margin-right="0.75in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="lot-first" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="lot-odd" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="lot-even" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.5in" margin-right="0.75in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="front-first" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="front-odd" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="front-even" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.5in" margin-right="0.75in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="body-first" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="body-odd" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="body-even" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.5in" margin-right="0.75in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="back-first" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="back-odd" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="back-even" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.5in" margin-right="0.75in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="index-first" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="index-odd" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.75in" margin-right="0.5in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="index-even" page-width="7.5in" page-height="9in" margin-top="0.5in" margin-bottom="0.25in" margin-left="0.5in" margin-right="0.75in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:page-sequence-master master-name="titlepage"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="titlepage-first" page-position="first"/><fo:conditional-page-master-reference master-reference="titlepage-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="titlepage-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="lot"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="lot-first" page-position="first"/><fo:conditional-page-master-reference master-reference="lot-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="lot-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="front"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="front-first" page-position="first"/><fo:conditional-page-master-reference master-reference="front-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="front-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="body"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="body-first" page-position="first"/><fo:conditional-page-master-reference master-reference="body-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="body-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="back"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="back-first" page-position="first"/><fo:conditional-page-master-reference master-reference="back-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="back-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="index"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="index-first" page-position="first"/><fo:conditional-page-master-reference master-reference="index-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="index-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:simple-page-master master-name="my-titlepage" page-width="7.5in" page-height="9in" margin-top="0" margin-bottom="0" margin-left="0" margin-right="0"><fo:region-body margin-bottom="0.5in" margin-top="0" column-gap="12pt" column-count="1"/></fo:simple-page-master></fo:layout-master-set><fo:declarations xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"><x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description xmlns:dc="http://purl.org/dc/elements/1.1/" rdf:about=""><dc:title>Couchbase Ruby Client Manual</dc:title><dc:creator>Sergey Avseyev</dc:creator></rdf:Description><rdf:Description xmlns:pdf="http://ns.adobe.com/pdf/1.3/" rdf:about=""/><rdf:Description xmlns:xmp="http://ns.adobe.com/xap/1.0/" rdf:about=""><xmp:CreatorTool>DocBook XSL Stylesheets with Apache FOP</xmp:CreatorTool></rdf:Description></rdf:RDF></x:xmpmeta></fo:declarations><fo:bookmark-tree><fo:bookmark internal-destination="idp309344" starting-state="hide"><fo:bookmark-title>Couchbase Ruby Client Manual</fo:bookmark-title></fo:bookmark><fo:bookmark internal-destination="toc...idp309344"><fo:bookmark-title>Table of Contents</fo:bookmark-title></fo:bookmark><fo:bookmark internal-destination="_abstract" starting-state="hide"><fo:bookmark-title>Chapter 1. Abstract</fo:bookmark-title></fo:bookmark><fo:bookmark internal-destination="_getting_started" starting-state="hide"><fo:bookmark-title>Chapter 2. Getting Started</fo:bookmark-title><fo:bookmark internal-destination="_installing_the_couchbase_client_libraries" starting-state="hide"><fo:bookmark-title>2.1. Installing the Couchbase Client Libraries</fo:bookmark-title></fo:bookmark><fo:bookmark internal-destination="_hello_couchbase" starting-state="hide"><fo:bookmark-title>2.2. Hello Couchbase</fo:bookmark-title></fo:bookmark></fo:bookmark><fo:bookmark internal-destination="_working_with_documents" starting-state="hide"><fo:bookmark-title>Chapter 3. Working with Documents</fo:bookmark-title><fo:bookmark internal-destination="_creating_and_updating_documents" starting-state="hide"><fo:bookmark-title>3.1. Creating and Updating Documents</fo:bookmark-title></fo:bookmark><fo:bookmark internal-destination="_reading_documents" starting-state="hide"><fo:bookmark-title>3.2. Reading Documents</fo:bookmark-title></fo:bookmark><fo:bookmark internal-destination="_deleting_documents" starting-state="hide"><fo:bookmark-title>3.3. Deleting Documents</fo:bookmark-title></fo:bookmark></fo:bookmark><fo:bookmark internal-destination="_advanced_topics" starting-state="hide"><fo:bookmark-title>Chapter 4. Advanced Topics</fo:bookmark-title><fo:bookmark internal-destination="_cas_and_locking" starting-state="hide"><fo:bookmark-title>4.1. CAS and Locking</fo:bookmark-title></fo:bookmark><fo:bookmark internal-destination="_persistence_and_replication" starting-state="hide"><fo:bookmark-title>4.2. Persistence and Replication</fo:bookmark-title></fo:bookmark></fo:bookmark><fo:bookmark internal-destination="_couchbase_rails_tutorial" starting-state="hide"><fo:bookmark-title>Chapter 5. Couchbase Rails Tutorial</fo:bookmark-title><fo:bookmark internal-destination="_tl_dr" starting-state="hide"><fo:bookmark-title>5.1. TL;DR</fo:bookmark-title></fo:bookmark><fo:bookmark internal-destination="_create_application_skeleton" starting-state="hide"><fo:bookmark-title>5.2. Create Application Skeleton</fo:bookmark-title></fo:bookmark><fo:bookmark internal-destination="_define_models" starting-state="hide"><fo:bookmark-title>5.3. Define Models</fo:bookmark-title></fo:bookmark><fo:bookmark internal-destination="_implement_controllers" starting-state="hide"><fo:bookmark-title>5.4. Implement Controllers</fo:bookmark-title></fo:bookmark><fo:bookmark internal-destination="_bonus_spatial_queries_sessions_and_cache" starting-state="hide"><fo:bookmark-title>5.5. Bonus: Spatial Queries, Sessions and Cache</fo:bookmark-title></fo:bookmark></fo:bookmark></fo:bookmark-tree><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="idp309344"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_abstract"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_getting_started"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_installing_the_couchbase_client_libraries"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_hello_couchbase"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_working_with_documents"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_creating_and_updating_documents"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_reading_documents"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_deleting_documents"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_advanced_topics"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_cas_and_locking"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_persistence_and_replication"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_couchbase_rails_tutorial"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_tl_dr"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_create_application_skeleton"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_define_models"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_implement_controllers"/><fox:destination xmlns:fox="http://xmlgraphics.apache.org/fop/extensions" internal-destination="_bonus_spatial_queries_sessions_and_cache"/><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="false" master-reference="my-titlepage" language="en" format="1" initial-page-number="1" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Couchbase Ruby Client Manual</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Couchbase Ruby Client Manual</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body"><fo:block text-align="center"><fo:external-graphic src="url(images/cover.jpg)" content-height="9in"/></fo:block></fo:flow></fo:page-sequence><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="false" master-reference="titlepage" language="en" format="1" initial-page-number="1" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"/></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"/></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body"><fo:block id="idp309344"><fo:block><fo:block><fo:block text-align="center" font-size="24.8832pt" space-before="18.6624pt" font-weight="bold" font-family="URW Bookman L,Symbol,ZapfDingbats"><fo:block keep-with-next.within-column="always" hyphenate="false">Couchbase Ruby Client Manual</fo:block></fo:block><fo:block font-size="17.28pt" space-before="10.8pt" keep-with-next.within-column="always" font-family="URW Bookman L,Symbol,ZapfDingbats" font-weight="bold" text-align="center"><fo:block>Sergey Avseyev</fo:block></fo:block></fo:block><fo:block><fo:block break-after="page"/><fo:block font-size="14.4pt" font-weight="bold" font-family="URW Bookman L,Symbol,ZapfDingbats"><fo:block>Couchbase Ruby Client Manual</fo:block></fo:block><fo:block font-size="10pt"><fo:block>Sergey Avseyev</fo:block></fo:block></fo:block><fo:block break-after="page"/></fo:block></fo:block></fo:flow></fo:page-sequence><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="false" master-reference="lot" language="en" format="i" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Couchbase Ruby Client Manual</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Couchbase Ruby Client Manual</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="1pc" end-indent="0pt"><fo:block id="toc...idp309344" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block><fo:block><fo:block space-before.minimum="1em" space-before.optimum="1.5em" space-before.maximum="2em" space-after="0.5em" margin-left="0pt" start-indent="0pt" font-size="17.28pt" font-weight="bold" font-family="URW Bookman L,Symbol,ZapfDingbats">Table of Contents</fo:block></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_abstract">1. Abstract</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_abstract"><fo:page-number-citation ref-id="_abstract"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_getting_started">2. Getting Started</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_getting_started"><fo:page-number-citation ref-id="_getting_started"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idp309344._getting_started" margin-left="24pt"><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_installing_the_couchbase_client_libraries">2.1. Installing the Couchbase Client Libraries</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_installing_the_couchbase_client_libraries"><fo:page-number-citation ref-id="_installing_the_couchbase_client_libraries"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_hello_couchbase">2.2. Hello Couchbase</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_hello_couchbase"><fo:page-number-citation ref-id="_hello_couchbase"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_working_with_documents">3. Working with Documents</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_working_with_documents"><fo:page-number-citation ref-id="_working_with_documents"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idp309344._working_with_documents" margin-left="24pt"><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_creating_and_updating_documents">3.1. Creating and Updating Documents</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_creating_and_updating_documents"><fo:page-number-citation ref-id="_creating_and_updating_documents"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_reading_documents">3.2. Reading Documents</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_reading_documents"><fo:page-number-citation ref-id="_reading_documents"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_deleting_documents">3.3. Deleting Documents</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_deleting_documents"><fo:page-number-citation ref-id="_deleting_documents"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_advanced_topics">4. Advanced Topics</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_advanced_topics"><fo:page-number-citation ref-id="_advanced_topics"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idp309344._advanced_topics" margin-left="24pt"><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_cas_and_locking">4.1. CAS and Locking</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_cas_and_locking"><fo:page-number-citation ref-id="_cas_and_locking"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_persistence_and_replication">4.2. Persistence and Replication</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_persistence_and_replication"><fo:page-number-citation ref-id="_persistence_and_replication"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_couchbase_rails_tutorial">5. Couchbase Rails Tutorial</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_couchbase_rails_tutorial"><fo:page-number-citation ref-id="_couchbase_rails_tutorial"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idp309344._couchbase_rails_tutorial" margin-left="24pt"><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_tl_dr">5.1. TL;DR</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_tl_dr"><fo:page-number-citation ref-id="_tl_dr"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_create_application_skeleton">5.2. Create Application Skeleton</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_create_application_skeleton"><fo:page-number-citation ref-id="_create_application_skeleton"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_define_models">5.3. Define Models</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_define_models"><fo:page-number-citation ref-id="_define_models"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_implement_controllers">5.4. Implement Controllers</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_implement_controllers"><fo:page-number-citation ref-id="_implement_controllers"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_bonus_spatial_queries_sessions_and_cache">5.5. Bonus: Spatial Queries, Sessions and Cache</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_bonus_spatial_queries_sessions_and_cache"><fo:page-number-citation ref-id="_bonus_spatial_queries_sessions_and_cache"/></fo:basic-link></fo:inline></fo:block></fo:block></fo:block></fo:flow></fo:page-sequence><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="false" master-reference="lot" language="en" format="i" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Couchbase Ruby Client Manual</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Couchbase Ruby Client Manual</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="1pc" end-indent="0pt"><fo:block id="lot...table...idp309344"><fo:block><fo:block><fo:block space-before.minimum="1em" space-before.optimum="1.5em" space-before.maximum="2em" space-after="0.5em" margin-left="0pt" start-indent="0pt" font-size="17.28pt" font-weight="bold" font-family="URW Bookman L,Symbol,ZapfDingbats">List of Tables</fo:block></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idp3848144">1.1. Product Compatibility for Couchbase Ruby SDK</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="idp3848144"><fo:page-number-citation ref-id="idp3848144"/></fo:basic-link></fo:inline></fo:block></fo:block></fo:flow></fo:page-sequence><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="false" master-reference="body" language="en" format="1" initial-page-number="1" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Abstract</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Abstract</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="1pc" end-indent="0pt"><fo:block id="_abstract"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats"><fo:block margin-left="0pt"><fo:block font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="12pt" space-before.minimum="12pt * 0.8" space-before.maximum="12pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Chapter 1. Abstract</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">This is the manual for 1.2 of the Couchbase Ruby client library, which
is compatible with Couchbase Server 2.0.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">This manual provides a reference to the key features and best
practices for using the Ruby Couchbase Client Library . The content
constitutes a reference to the core API, not a complete guide to the
entire API functionality.</fo:block><fo:block id="idp3848144" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="14.4pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Table 1.1. Product Compatibility for Couchbase Ruby SDK</fo:block><fo:table border-before-width.conditionality="retain" border-collapse="collapse" border-start-style="solid" border-end-style="solid" border-top-style="solid" border-bottom-style="solid" border-start-width="2px" border-end-width="2px" border-top-width="2px" border-bottom-width="2px" border-start-color="#527bbd" border-end-color="#527bbd" border-top-color="#527bbd" border-bottom-color="#527bbd" table-layout="fixed" width="100%"><fo:table-column column-number="1" column-width="proportional-column-width(33)"/><fo:table-column column-number="2" column-width="proportional-column-width(33)"/><fo:table-column column-number="3" column-width="proportional-column-width(33)"/><fo:table-header xmlns:rx="http://www.renderx.com/XSL/Extensions" start-indent="0pt" end-indent="0pt"><fo:table-row keep-with-next.within-column="always"><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="1px" border-bottom-style="solid" border-bottom-color="#527bbd" border-end-width="1px" border-end-style="solid" border-end-color="#527bbd" display-align="before" text-align="left"><fo:block font-weight="bold"> Product              </fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="1px" border-bottom-style="solid" border-bottom-color="#527bbd" border-end-width="1px" border-end-style="solid" border-end-color="#527bbd" display-align="before" text-align="left"><fo:block font-weight="bold"> Compatible </fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="1px" border-bottom-style="solid" border-bottom-color="#527bbd" display-align="before" text-align="left"><fo:block font-weight="bold"> All Features</fo:block></fo:table-cell></fo:table-row></fo:table-header><fo:table-body xmlns:rx="http://www.renderx.com/XSL/Extensions" start-indent="0pt" end-indent="0pt"><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="1px" border-bottom-style="solid" border-bottom-color="#527bbd" border-end-width="1px" border-end-style="solid" border-end-color="#527bbd" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Couchbase Server 1.8</fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="1px" border-bottom-style="solid" border-bottom-color="#527bbd" border-end-width="1px" border-end-style="solid" border-end-color="#527bbd" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">✓</fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="1px" border-bottom-style="solid" border-bottom-color="#527bbd" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">✓</fo:block></fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-end-width="1px" border-end-style="solid" border-end-color="#527bbd" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Couchbase Server 2.0</fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-end-width="1px" border-end-style="solid" border-end-color="#527bbd" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">✓</fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">✓</fo:block></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block><fo:block font-weight="bold" font-size="14.4pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">External Community Resources</fo:block><fo:list-block id="idp235632" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idp236192" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:basic-link external-destination="url(http://www.couchbase.com/develope/ruby/next)">Home page on couchbase.com</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://www.couchbase.com/develope/ruby/next)">http://www.couchbase.com/develope/ruby/next</fo:basic-link>]</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp237632" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:basic-link external-destination="url(https://rubygems.org/gems/couchbase)">Download client library</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://rubygems.org/gems/couchbase)">https://rubygems.org/gems/couchbase</fo:basic-link>]</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp239104" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:basic-link external-destination="url(http://rubydoc.info/gems/couchbase)">RDoc</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://rubydoc.info/gems/couchbase)">http://rubydoc.info/gems/couchbase</fo:basic-link>]</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp240576" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:basic-link external-destination="url(http://www.couchbase.com/forums/sdks/sdks)">SDK forum</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://www.couchbase.com/forums/sdks/sdks)">http://www.couchbase.com/forums/sdks/sdks</fo:basic-link>]</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp242000" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:basic-link external-destination="url(http://couchbase.com/issues/browse/RCBC)">Issue tracker</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://couchbase.com/issues/browse/RCBC)">http://couchbase.com/issues/browse/RCBC</fo:basic-link>]</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp217568" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:basic-link external-destination="url(https://github.com/couchbase/couchbase-ruby-client)">Sourse code repository</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://github.com/couchbase/couchbase-ruby-client)">https://github.com/couchbase/couchbase-ruby-client</fo:basic-link>]</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idp219008" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em"><fo:list-block provisional-distance-between-starts="36pt + 18pt" provisional-label-separation="18pt"><fo:list-item><fo:list-item-label end-indent="label-end()"><fo:block><fo:external-graphic width="auto" height="auto" content-width="36pt" src="url(images/icons/warning.png)"/></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block font-size="14pt" font-weight="bold" hyphenate="false" keep-with-next.within-column="always">Warning</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The following document is still in production, and is not
         considered complete or exhaustive.</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:flow></fo:page-sequence><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="false" master-reference="body" language="en" format="1" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Getting Started</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Getting Started</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="1pc" end-indent="0pt"><fo:block id="_getting_started"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats"><fo:block margin-left="0pt"><fo:block font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="12pt" space-before.minimum="12pt * 0.8" space-before.maximum="12pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Chapter 2. Getting Started</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Awesome that you want to learn more about Couchbase! This is the right
place to start your journey. This chapter will teach you the basics of
Couchbase and how to interact with it through the Ruby Client SDK.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">If you haven’t already, download the latest Couchbase Server 2.0
release and install it. While following the download instructions and
setup wizard, make sure install the <fo:inline font-size="10pt" font-family="LiberationMono">beer-sample</fo:inline> default bucket. It
contains sample data of beers and breweries, which we’ll be using in
our examples here. If you’ve already installed Couchbase Server 2.0
and didn’t install the <fo:inline font-size="10pt" font-family="LiberationMono">beer-sample</fo:inline> bucket (or if you deleted it),
just open the Web-UI and navigate to "Settings/Sample Buckets".
Activate the <fo:inline font-size="10pt" font-family="LiberationMono">beer-sample</fo:inline> checkbox and click "Create". In the right
hand corner you’ll see a notification box that will disappear once the
bucket is ready to be used.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Here’s a quick outline of what you’ll learn in this chapter:</fo:block><fo:list-block id="idp225856" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idp363264" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Install the library with its dependencies.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp364144" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Write a simple program to demonstrate connecting to Couchbase and
  saving some documents.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">From here on, we’ll assume that you have a Couchbase Server 2.0
release running and the <fo:inline font-size="10pt" font-family="LiberationMono">beer-sample</fo:inline> bucket configured. If you need
any help on setting up everything, there is plenty of documentation
available:</fo:block><fo:list-block id="idp366704" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idp366960" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Using the <fo:basic-link external-destination="url(http://couchbase.com/docs/couchbase-manual-2.0/couchbase-introduction.html)">Couchbase Web Console</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://couchbase.com/docs/couchbase-manual-2.0/couchbase-introduction.html)">http://couchbase.com/docs/couchbase-manual-2.0/couchbase-introduction.html</fo:basic-link>]</fo:inline>,
  for information on using the Couchbase Administrative Console,
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp368560" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:basic-link external-destination="url(http://couchbase.com/docs/couchbase-manual-2.0/couchbase-admin-web-console.html)">Couchbase CLI</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://couchbase.com/docs/couchbase-manual-2.0/couchbase-admin-web-console.html)">http://couchbase.com/docs/couchbase-manual-2.0/couchbase-admin-web-console.html</fo:basic-link>]</fo:inline>,
  for the command line interface,
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp370064" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:basic-link external-destination="url(http://couchbase.com/docs/couchbase-manual-2.0/couchbase-admin-restapi.html)">Couchbase REST API</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://couchbase.com/docs/couchbase-manual-2.0/couchbase-admin-restapi.html)">http://couchbase.com/docs/couchbase-manual-2.0/couchbase-admin-restapi.html</fo:basic-link>]</fo:inline>,
  for creating and managing Couchbase resources.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="_installing_the_couchbase_client_libraries"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Installing the Couchbase Client Libraries</fo:marker><fo:block font-size="24.8832pt">2.1. Installing the Couchbase Client Libraries</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Before continuing you should ensure you have a working Ruby
environment up and running. We recommend Ruby 1.9.2 or 1.8.7
<fo:basic-link external-destination="url(http://ruby-lang.org)">http://ruby-lang.org</fo:basic-link>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">You can verify that Ruby is installed by typing the following command:</fo:block><fo:block id="idp374368" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">shell&gt; ruby -v
ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Another dependency needed for client is libcouchbase. Please consult
[<fo:basic-link external-destination="url(http://www.couchbase.com/develop/c/current])">C Client Library</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://www.couchbase.com/develop/c/current])">http://www.couchbase.com/develop/c/current]</fo:basic-link>]</fo:inline> page
about ways to get it on your system. Here we will assume you are using
the Ubuntu/Debian GNU/Linux family and have the <fo:inline font-size="10pt" font-family="LiberationMono">apt</fo:inline> tool.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Note that the libcouchbase dependency is not needed if you are on
Microsoft Windows, as all dependencies are bundled in the source.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Once you have installed libcouchbase, you are then ready to install
the most recent client using rubygems.</fo:block><fo:block id="idp378576" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">shell&gt; gem install couchbase
Fetching: couchbase-1.2.0.gem (100%)
Building native extensions.  This could take a while...
Successfully installed couchbase-1.2.0
1 gem installed</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Lets load and verify library version.</fo:block><fo:block id="idp194000" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">shell&gt; ruby -rrubygems -rcouchbase -e 'puts Couchbase::VERSION'
1.2.0</fo:block></fo:block><fo:block id="_hello_couchbase"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Hello Couchbase</fo:marker><fo:block font-size="24.8832pt">2.2. Hello Couchbase</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">To follow the tradition of programming tutorials, we’ll start with
"Hello Couchbase". In the first example, we’ll connect to the Cluster,
retrieve the document, print it out and modify it. This first
example contains the full sourcecode, but in later example we’ll omit
the preamble and assume we’re already connected to the cluster.</fo:block><fo:block id="idp197056" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">require <fo:inline color="#0000FF">'rubygems'</fo:inline>
require <fo:inline color="#0000FF">'couchbase'</fo:inline>

client = Couchbase.connect(<fo:inline color="#0000FF">:bucket</fo:inline> =&gt; <fo:inline color="#0000FF">"beer-sample"</fo:inline>,
                           <fo:inline color="#0000FF">:host</fo:inline> =&gt; <fo:inline color="#0000FF">"localhost"</fo:inline>)

beer = client.get(<fo:inline color="#0000FF">"aass_brewery-juleol"</fo:inline>)
puts <fo:inline color="#0000FF">"</fo:inline><fo:inline color="#0000FF">#{</fo:inline>beer[<fo:inline color="#0000FF">'name'</fo:inline>]<fo:inline color="#0000FF">}</fo:inline><fo:inline color="#0000FF">, ABV: </fo:inline><fo:inline color="#0000FF">#{</fo:inline>beer[<fo:inline color="#0000FF">'abv'</fo:inline>]<fo:inline color="#0000FF">}</fo:inline><fo:inline color="#0000FF">"</fo:inline>

beer[<fo:inline color="#0000FF">'comment'</fo:inline>] = <fo:inline color="#0000FF">"Random beer from Norway"</fo:inline>
client.replace(<fo:inline color="#0000FF">"aass_brewery-juleol"</fo:inline>, beer)

client.disconnect
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">While this code should be very easy to grasp, there is a lot going on
worth a little more discussion:</fo:block><fo:list-block id="idp199744" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idp200000" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Connecting: the <fo:inline font-size="10pt" font-family="LiberationMono">Couchbase.connect</fo:inline> basically creates an instance of
  <fo:inline font-size="10pt" font-family="LiberationMono">Couchbase::Bucket</fo:inline> class internally passing all arguments to its
  contructor. You can see complete list of options on the
  <fo:basic-link external-destination="url(http://rdoc.info/gems/couchbase/Couchbase/Bucket#initialize-instance_method)">API documentation site</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://rdoc.info/gems/couchbase/Couchbase/Bucket#initialize-instance_method)">http://rdoc.info/gems/couchbase/Couchbase/Bucket#initialize-instance_method</fo:basic-link>]</fo:inline>.
  In our example the most interesting option is <fo:inline font-size="10pt" font-family="LiberationMono">:bucket</fo:inline>. Because our
  data bucket isn’t "default" we must specify it during connection.
  The bucket is the container for all your documents. Inside a bucket,
  a key<fo:leader leader-length="0.2em"/>—<fo:leader leader-length="0.2em"/>the identifier for a document<fo:leader leader-length="0.2em"/>—<fo:leader leader-length="0.2em"/>must be unique. In
  production environments, it is recommended to use a password on a
  bucket (this can be configured during bucket creation), but when you
  are just starting out using the default bucket without a password is
  fine. Note that the <fo:inline font-size="10pt" font-family="LiberationMono">beer-sample</fo:inline> bucket also doesn’t have a password,
  so just change the bucket name and you’re set. Another option is
  <fo:inline font-size="10pt" font-family="LiberationMono">:host</fo:inline> which tells the client library the address of the cluster. While
  passing in only one host is fine, it is strongly recommended to add
  two or three (of course, if your cluster has more than one node) and
  use <fo:inline font-size="10pt" font-family="LiberationMono">:node_list</fo:inline> option instead. It is important to understand that
  this list does not have to contain all nodes in the cluster<fo:leader leader-length="0.2em"/>—<fo:leader leader-length="0.2em"/>you
  just need to provide a few so that during the initial bootstrap
  phase the Client is able to connect to the server.  Any two or three
  nodes will be fine, but maintain this list.  After this has
  happened, the Client automatically fetches the cluster configuration
  and keeps it up to date, even when the cluster topology changes.
  This means that you don’t need to change your application config at
  all when you resize your cluster.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp207696" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Set and get: these two operations are the most fundamental
  ones. You can use set to create or completely replace a document inside your
  bucket and get to read it back afterwards. There are lots of
  arguments and variations, but if you just use them as shown in the
  previous example will get you pretty far. The sample is using the
  <fo:inline font-size="10pt" font-family="LiberationMono">Couchbase::Bucket#replace</fo:inline> operation. It behaves exactly like
  <fo:inline font-size="10pt" font-family="LiberationMono">#set</fo:inline> but will raise an error if the document isn’t in the
  bucket. Note that by default all operations are using JSON to store
  your documents, so make sure it is possible to represent your values
  in this format. If not, you might use <fo:inline font-size="10pt" font-family="LiberationMono">:marshal</fo:inline> format. Find more
  info about the formats in the API documentation.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp211856" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Disconnecting: at the end of the program (or when you shutdown your
  server instance), you should use the <fo:inline font-size="10pt" font-family="LiberationMono">Couchbase::Bucket#disconnect</fo:inline>
  method. But you should know that the instance will be disconnected
  properly if it is destroyed by garbage collector.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">That’s it. We’re ready to run our first Couchbase program.</fo:block><fo:block id="idp214512" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">shell&gt; ruby hello.rb
Juleøl, ABV: 5.9</fo:block></fo:block></fo:flow></fo:page-sequence><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="false" master-reference="body" language="en" format="1" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Working with Documents</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Working with Documents</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="1pc" end-indent="0pt"><fo:block id="_working_with_documents"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats"><fo:block margin-left="0pt"><fo:block font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="12pt" space-before.minimum="12pt * 0.8" space-before.maximum="12pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Chapter 3. Working with Documents</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">A document in Couchbase Server consists of a value and meta
information, like a unique key, a CAS value, flags etc.  These are all stored in a bucket.
A document can be anything, but it is recommended to use the JSON
format. JSON is very convenient for storing structured data with
little overhead, and is also used inside the View engine. This means
that if you want to get most out of Couchbase Server 2.0, use JSON.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The couchbase client will use any of accessible JSON libraries
supported by <fo:basic-link external-destination="url(https://rubygems.org/gems/multi_json)">multi_json gem</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://rubygems.org/gems/multi_json)">https://rubygems.org/gems/multi_json</fo:basic-link>]</fo:inline>.
This mean if your values are serializable with <fo:inline font-size="10pt" font-family="LiberationMono">MultiJson.dump</fo:inline>, you
can pass them to mutator methods and be sure you will get them later in
the same form.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The following chapter introduces the basic operations that you can use
as the fundamental building blocks of your application.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Here’s a quick outline of what you’ll learn in this chapter:</fo:block><fo:list-block id="idp5716896" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idp5717872" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Write a program to demonstrate using Create, Read, Update, Delete
  (CRUD) operations on documents.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp5718864" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Explore some of the API methods that will take you further than what
  you’ve seen previously.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="_creating_and_updating_documents"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Creating and Updating Documents</fo:marker><fo:block font-size="24.8832pt">3.1. Creating and Updating Documents</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Couchbase Server provides a set of commands to store documents. The
commands are very similar to each other and differ only in their
meaning on the server-side. These are:</fo:block><fo:block id="idp5721472" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:table border-before-width.conditionality="retain" border-collapse="collapse" border-start-style="none" border-end-style="none" border-top-style="none" border-bottom-style="none" table-layout="fixed" width="100%"><fo:table-column column-number="1" column-width="proportional-column-width(15)"/><fo:table-column column-number="2" column-width="proportional-column-width(85)"/><fo:table-body xmlns:rx="http://www.renderx.com/XSL/Extensions" start-indent="0pt" end-indent="0pt"><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-size="10pt" font-family="LiberationMono">set</fo:inline>
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Stores a document in Couchbase Server (identified by its unique
        key) and overrides the previous document (if there was one).
</fo:block>
</fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-size="10pt" font-family="LiberationMono">add</fo:inline>
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Adds a document in Couchbase Server (identified by its unique
        key) and fails if there is already a document with the same
        key stored.
</fo:block>
</fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-size="10pt" font-family="LiberationMono">replace</fo:inline>
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Replaces a document in Couchbase Server (identified by its
            unique key) and fails if there is no document with the
            given key already in place.
</fo:block>
</fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">There are also additional commands mutation commands, which do make
sense when you are working in <fo:inline font-size="10pt" font-family="LiberationMono">:plain</fo:inline> mode, because they are
implmented on the server and not JSON-aware. But still they might be
useful in your application:</fo:block><fo:block id="idp5734272" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:table border-before-width.conditionality="retain" border-collapse="collapse" border-start-style="none" border-end-style="none" border-top-style="none" border-bottom-style="none" table-layout="fixed" width="100%"><fo:table-column column-number="1" column-width="proportional-column-width(15)"/><fo:table-column column-number="2" column-width="proportional-column-width(85)"/><fo:table-body xmlns:rx="http://www.renderx.com/XSL/Extensions" start-indent="0pt" end-indent="0pt"><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-size="10pt" font-family="LiberationMono">prepend</fo:inline>
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Prepend given string to the value. The concatenation is
            done on the server side.
</fo:block>
</fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-size="10pt" font-family="LiberationMono">append</fo:inline>
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Append given string to the value. The concatenation is
           also done on the server side.
</fo:block>
</fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-size="10pt" font-family="LiberationMono">increment</fo:inline>
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Increment, atomically, the value. The value is a string
              representation of an unsigned integer. The new value is
              returned by the operation. By default it
              will increment by one. See API reference for other options.
</fo:block>
</fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-size="10pt" font-family="LiberationMono">decrement</fo:inline>
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Decrement, atomically, the value. The value is a string
              representation of an unsigned integer. The new value is
              returned by the operation. By default it
              will decrement by one. See API reference for other options.
</fo:block>
</fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The SDK provides several options for these operations, but to start
out here are the simplest forms:</fo:block><fo:block id="idp5749632" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">key = <fo:inline color="#0000FF">"aass_brewery-juleol"</fo:inline>
doc = {<fo:inline color="#0000FF">"name"</fo:inline> =&gt; <fo:inline color="#0000FF">"Juleøl"</fo:inline>, <fo:inline color="#0000FF">"abv"</fo:inline> =&gt; <fo:inline color="#0000FF">5</fo:inline>.<fo:inline color="#0000FF">9</fo:inline>}

client.add(key, doc);
client.set(key, doc);
client.replace(key, doc);
</fo:block></fo:block><fo:block id="_reading_documents"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Reading Documents</fo:marker><fo:block font-size="24.8832pt">3.2. Reading Documents</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">With Couchbase Server 2.0, you have two ways of fetching your
documents: either by the unique key through the get method, or through
Views. Since Views are more complex, let’s just look at a simple get first:</fo:block><fo:block id="idp5752800" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">doc = client.get(<fo:inline color="#0000FF">"aass_brewery-juleol"</fo:inline>)

keys = [<fo:inline color="#0000FF">"foo"</fo:inline>, <fo:inline color="#0000FF">"bar"</fo:inline>]
docs = client.get(keys, <fo:inline color="#0000FF">:quiet</fo:inline> =&gt; <fo:inline font-weight="bold" color="#000080">true</fo:inline>)
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">In this case you will receve the Hash document you stored earlier. If
there no such key in the bucket, the exception
<fo:inline font-size="10pt" font-family="LiberationMono">Couchbase::Error:NotFound</fo:inline> will be raised. But you can suppress all
<fo:inline font-size="10pt" font-family="LiberationMono">NotFound</fo:inline> errors by using option <fo:inline font-size="10pt" font-family="LiberationMono">:quiet =&gt; true</fo:inline> and the method will
return <fo:inline font-size="10pt" font-family="LiberationMono">nil</fo:inline> instead. The <fo:inline font-size="10pt" font-family="LiberationMono">Couchbase::Bucket#get</fo:inline> method can also
accept list of keys returning list of documents.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">With Couchbase Server 2.0, the very powerful ability to query your
documents across this distributed system through secondary indexes (Views) has been added to your
toolbelt. This guide gets you started on how to use them through the
Ruby SDK, if you want to learn more please refer to
<fo:basic-link external-destination="url(http://www.couchbase.com/docs/couchbase-manual-2.0/couchbase-views.html)">the
chapter in the Couchbase Server 2.0 documentation</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://www.couchbase.com/docs/couchbase-manual-2.0/couchbase-views.html)">http://www.couchbase.com/docs/couchbase-manual-2.0/couchbase-views.html</fo:basic-link>]</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Once you created your View in the UI, you can query it from the SDK in
two steps. First, you grab the design document definition from the
cluster, second query view with options you need and use results.
In its simplest form, it looks like this:</fo:block><fo:block id="idp5760304" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0"><fo:inline font-style="italic" color="#008800"># 1: Get the design document definition</fo:inline>
ddoc = client.design_docs[<fo:inline color="#0000FF">"beer"</fo:inline>]
ddoc.views      <fo:inline font-style="italic" color="#008800">#=&gt; ["brewery_beers", "by_location"]</fo:inline>

<fo:inline font-style="italic" color="#008800"># 2: Query the view and use results</fo:inline>
ddoc.brewery_beers.each <fo:inline font-weight="bold" color="#000080">do</fo:inline> |row|
  puts row.key
  puts row.value
  puts row.id
  puts row.doc
<fo:inline font-weight="bold" color="#000080">end</fo:inline>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Note that the view request won’t be executed until you will try to
access the results. This means that you can pass view object
(<fo:inline font-size="10pt" font-family="LiberationMono">ddoc.brewery_beers</fo:inline> here) without executing it.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Views can be queried with a large amount of options to change what the
results of the query will contain. All supported
options are available as items in options Hash accepted either by the
view method or by <fo:inline font-size="10pt" font-family="LiberationMono">#each</fo:inline> iterator on the view. Here are some of them:</fo:block><fo:block id="idp5764544" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:table border-before-width.conditionality="retain" border-collapse="collapse" border-start-style="none" border-end-style="none" border-top-style="none" border-bottom-style="none" table-layout="fixed" width="100%"><fo:table-column column-number="1" column-width="proportional-column-width(15)"/><fo:table-column column-number="2" column-width="proportional-column-width(85)"/><fo:table-body xmlns:rx="http://www.renderx.com/XSL/Extensions" start-indent="0pt" end-indent="0pt"><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
include_docs (Boolean)
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Used to define if the complete documents
                         should be fetched with the result (<fo:inline font-size="10pt" font-family="LiberationMono">false</fo:inline>
                         by default).  Note this will actually fetch
                         the document itself from the cache, so if it
                         has been changed or deleted you may not
                         receive a document that matches the view, or
                         any at all.
</fo:block>
</fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
reduce (Boolean)
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Used to enable/disable the reduce function (if
                   there is one defined on the server). <fo:inline font-size="10pt" font-family="LiberationMono">true</fo:inline> by
                   default.
</fo:block>
</fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
limit (Fixnum)
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Limit the number of results that should be returned.
</fo:block>
</fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
descending (Boolean)
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Revert the sorting order of the result set.
                       (<fo:inline font-size="10pt" font-family="LiberationMono">false</fo:inline> by default)
</fo:block>
</fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
stale (Boolean, Symbol)
</fo:block>
</fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before"><fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Can be used to define the tradeoff between
                          performance and freshness of the data.
                           (<fo:inline font-size="10pt" font-family="LiberationMono">:update_after</fo:inline> by default)
</fo:block>
</fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Now that we have our View information in place, we can issue the
query, which actually triggers the scatter-gather data loading process
on the Cluster. We can use it to iterate over the results and print
out some details (here is a more complete example which also includes
the full documents and only fetches the first five results). The
resulting information is encapsulated inside the <fo:inline font-size="10pt" font-family="LiberationMono">ViewRow</fo:inline> object.</fo:block><fo:block id="idp5782800" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">view = client.design_docs[<fo:inline color="#0000FF">"beer"</fo:inline>].brewery_beers

<fo:inline font-style="italic" color="#008800"># Include all docs and limit to 5</fo:inline>
view.each(<fo:inline color="#0000FF">:include_docs</fo:inline> =&gt; <fo:inline font-weight="bold" color="#000080">true</fo:inline>, <fo:inline color="#0000FF">:limit</fo:inline> =&gt; <fo:inline color="#0000FF">5</fo:inline>) <fo:inline font-weight="bold" color="#000080">do</fo:inline> |row|
  puts row.id
  <fo:inline font-style="italic" color="#008800"># The full document (as a Hash) is available through row.doc</fo:inline>
<fo:inline font-weight="bold" color="#000080">end</fo:inline>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">In the logs, you can see the corresponding document keys automatically sorted (ascending):</fo:block><fo:block id="idp5784656" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">21st_amendment_brewery_cafe
21st_amendment_brewery_cafe-21a_ipa
21st_amendment_brewery_cafe-563_stout
21st_amendment_brewery_cafe-amendment_pale_ale
21st_amendment_brewery_cafe-bitter_american</fo:block></fo:block><fo:block id="_deleting_documents"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Deleting Documents</fo:marker><fo:block font-size="24.8832pt">3.3. Deleting Documents</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">If you want to get rid of a document, you can use the delete operation:</fo:block><fo:block id="idp5787040" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">client.delete(<fo:inline color="#0000FF">"aass_brewery-juleol"</fo:inline>);
</fo:block></fo:block></fo:flow></fo:page-sequence><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="false" master-reference="body" language="en" format="1" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Advanced Topics</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Advanced Topics</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="1pc" end-indent="0pt"><fo:block id="_advanced_topics"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats"><fo:block margin-left="0pt"><fo:block font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="12pt" space-before.minimum="12pt * 0.8" space-before.maximum="12pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Chapter 4. Advanced Topics</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">This chapter introduces some techniques topics that you can use to
further extend your Couchbase vocabulary.</fo:block><fo:block id="_cas_and_locking"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">CAS and Locking</fo:marker><fo:block font-size="24.8832pt">4.1. CAS and Locking</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">If you need to coordinate shared access on documents, Couchbase helps
you with two approaches. Depending on the application you may need to
use both of them, but in general it is better (if feasible) to lean
towards CAS because it provides the better performance
characteristics.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Optimistic Locking. </fo:inline>Each document has a unique identifier associated with it (the CAS
value), which changes when the document itself is mutated. You can
fetch the CAS value for a given key and pass it to any mutator
operation to protect it. The update will only succeed, when the CAS
value is still the same. This is why it’s called optimistic locking.
Someone else can still read and try to update the document, but it
will fail once the CAS value has changed. Here is a example on how to
do it with the Ruby SDK:</fo:block><fo:block id="idp5792848" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">key = <fo:inline color="#0000FF">"eagle_brewing-golden"</fo:inline>
<fo:inline font-style="italic" color="#008800"># Reads the document with the CAS value.</fo:inline>
beer, flags, cas = client.get(key, <fo:inline color="#0000FF">:extended</fo:inline> =&gt; <fo:inline font-weight="bold" color="#000080">true</fo:inline>)

<fo:inline font-style="italic" color="#008800"># Updates the document and tries to store it back.</fo:inline>
beer[<fo:inline color="#0000FF">"name"</fo:inline>] = <fo:inline color="#0000FF">"Some other Name"</fo:inline>
client.set(key, beer, <fo:inline color="#0000FF">:cas</fo:inline> =&gt; cas, <fo:inline color="#0000FF">:flags</fo:inline> =&gt; flags)
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Note that this also means that all your application need to follow the
same code path (cooperative locking). If you use <fo:inline font-size="10pt" font-family="LiberationMono">#set</fo:inline> somewhere else
in the code on the same document, it will work even if the CAS itself
is out of date (that’s because the normal <fo:inline font-size="10pt" font-family="LiberationMono">#set</fo:inline> method doesn’t care
about those values at all). Of course, the CAS itself changes then and
the mutation operation would fail afterwards.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">There is also shortcut operation for doing optimistic locking
<fo:inline font-size="10pt" font-family="LiberationMono">Bucket#cas</fo:inline>. Internally it does the same thing but abstract you from
storing and passing meta information. Here is the previous example
rewritten to use this operation:</fo:block><fo:block id="idp5798256" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">key = <fo:inline color="#0000FF">"eagle_brewing-golden"</fo:inline>
client.cas(key) <fo:inline font-weight="bold" color="#000080">do</fo:inline> |beer|
  beer[<fo:inline color="#0000FF">"name"</fo:inline>] = <fo:inline color="#0000FF">"Some other Name"</fo:inline>
  <fo:inline font-style="italic" color="#008800"># return new value from block</fo:inline>
  beer
<fo:inline font-weight="bold" color="#000080">end</fo:inline>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Note that you should return new value from the block. If you will skip
it, it will use <fo:inline font-size="10pt" font-family="LiberationMono">"Some other Name"</fo:inline> as new value.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Pessimistic Locking. </fo:inline>If you want to lock a document completely (or an object graph), you
can use the <fo:inline font-size="10pt" font-family="LiberationMono">Bucket#get</fo:inline> operation with <fo:inline font-size="10pt" font-family="LiberationMono">:lock</fo:inline> option. The option
accepts either boolean (where truth does make sense really) or Fixnum
meaning the time period where the lock is valid. The server will
release lock after the that period (or maximum value, which configured
on the server). Other threads can still run <fo:inline font-size="10pt" font-family="LiberationMono">get</fo:inline> queries queries
against the document, but mutation operations without a CAS will fail.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">You can determine actual default and maximum values calling
<fo:inline font-size="10pt" font-family="LiberationMono">Bucket#stats</fo:inline> without arguments and inspecting keys
<fo:inline font-size="10pt" font-family="LiberationMono">"ep_getl_default_timeout"</fo:inline> and <fo:inline font-size="10pt" font-family="LiberationMono">"ep_getl_max_timeout"</fo:inline>
correspondingly.</fo:block><fo:block id="idp5806880" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">key = <fo:inline color="#0000FF">"eagle_brewing-golden"</fo:inline>;

<fo:inline font-style="italic" color="#008800"># Get with Lock</fo:inline>
beer, flags, cas = client.get(key, <fo:inline color="#0000FF">:lock</fo:inline> =&gt; <fo:inline font-weight="bold" color="#000080">true</fo:inline>, <fo:inline color="#0000FF">:extended</fo:inline> =&gt; <fo:inline font-weight="bold" color="#000080">true</fo:inline>);

<fo:inline font-style="italic" color="#008800"># Update the document</fo:inline>
beer[<fo:inline color="#0000FF">"name"</fo:inline>] = <fo:inline color="#0000FF">"Some other Name"</fo:inline>

<fo:inline font-style="italic" color="#008800"># Try to set without the lock</fo:inline>
client.set(key, beer, <fo:inline color="#0000FF">:flags</fo:inline> =&gt; flags)
<fo:inline font-style="italic" color="#008800">#=&gt; will raise Couchbase::Error::KeyExists</fo:inline>

<fo:inline font-style="italic" color="#008800"># Try to set with the CAS aquired, will be OK</fo:inline>
client.set(key, beer, <fo:inline color="#0000FF">:flags</fo:inline> =&gt; flags, <fo:inline color="#0000FF">:cas</fo:inline> =&gt; cas)
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Once you update the document, the lock will be released. There is also
the <fo:inline font-size="10pt" font-family="LiberationMono">Bucket#unlock</fo:inline> method available through which you can unlock the
document.</fo:block></fo:block><fo:block id="_persistence_and_replication"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Persistence and Replication</fo:marker><fo:block font-size="24.8832pt">4.2. Persistence and Replication</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">By default, the mutation operations return when Couchbase Server has
accepted the command and stored it in memory (disk persistence and
replication is handled asynchronously by the cluster). That’s one of
the reason why it’s so fast. For most use-cases, that’s the behavior
that you need. Sometimes though, you want to trade in performance for
data-safety and wait until the document has been saved to disk and/or
replicated to other hosts.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The Ruby SDK provides <fo:inline font-size="10pt" font-family="LiberationMono">:observe</fo:inline> option for all mutation operations.
You can claim various persistence conditions using this option.
Basically its argument is a Hash with three possible keys, describing
the condition when the mutator will yield the result:</fo:block><fo:list-block id="idp5813472" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idp5814448" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-size="10pt" font-family="LiberationMono">:replicated</fo:inline> (Fixnum) describe how many nodes should receive
replicated copy of the document.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp5816016" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-size="10pt" font-family="LiberationMono">:persisted</fo:inline> (Fixnum) describe how many nodes should persist the
document to the disk. The nodes include master node, where the key
resides and all replica nodes.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp5817664" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-size="10pt" font-family="LiberationMono">:timeout</fo:inline> (Fixnum) the timeout period in microseconds. After
passing, the operation condition will be considered timed out and
appropriate exception will be thrown. Default value could be addressed
using <fo:inline font-size="10pt" font-family="LiberationMono">Bucket#default_observe_timeout</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Here is an example on how to make sure that the document has been
persisted on its master node, but also replicated to at least one of
its replicas.</fo:block><fo:block id="idp5820736" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">key = <fo:inline color="#0000FF">"important"</fo:inline>
value = <fo:inline color="#0000FF">"document"</fo:inline>
client.set(key, value, <fo:inline color="#0000FF">:observe</fo:inline> =&gt; {<fo:inline color="#0000FF">:persisted</fo:inline> =&gt; <fo:inline color="#0000FF">1</fo:inline>, <fo:inline color="#0000FF">:replicated</fo:inline> =&gt; <fo:inline color="#0000FF">1</fo:inline>})
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">You can also separate persistence requirement from actual operations,
and in this case, you can wait for several keys:</fo:block><fo:block id="idp5822736" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">keys = []
(<fo:inline color="#0000FF">1</fo:inline>..<fo:inline color="#0000FF">5</fo:inline>).each <fo:inline font-weight="bold" color="#000080">do</fo:inline> |nn|
  key = <fo:inline color="#0000FF">"important-</fo:inline><fo:inline color="#0000FF">#{</fo:inline>nn<fo:inline color="#0000FF">}</fo:inline><fo:inline color="#0000FF">"</fo:inline>
  keys &lt;&lt; key
  client.set(key, <fo:inline color="#0000FF">"document-</fo:inline><fo:inline color="#0000FF">#{</fo:inline>nn<fo:inline color="#0000FF">}</fo:inline><fo:inline color="#0000FF">"</fo:inline>)
<fo:inline font-weight="bold" color="#000080">end</fo:inline>
client.observe_and_wait(keys, <fo:inline color="#0000FF">:persisted</fo:inline> =&gt; <fo:inline color="#0000FF">1</fo:inline>, <fo:inline color="#0000FF">:replicated</fo:inline> =&gt; <fo:inline color="#0000FF">1</fo:inline>)
</fo:block></fo:block></fo:flow></fo:page-sequence><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="false" master-reference="body" language="en" format="1" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Couchbase Rails Tutorial</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Couchbase Rails Tutorial</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(5)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="1pc" end-indent="0pt"><fo:block id="_couchbase_rails_tutorial"><fo:block font-family="URW Bookman L,Symbol,ZapfDingbats"><fo:block margin-left="0pt"><fo:block font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="12pt" space-before.minimum="12pt * 0.8" space-before.maximum="12pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Chapter 5. Couchbase Rails Tutorial</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The goal of this chapter is to show how to write more advanced
application using Couchbase and Rails framework.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">We assume here that you are passed "Getting Started" section already,
if not, we recommend to take a look, because it describes how to
install and verify Ruby SDK.</fo:block><fo:block id="_tl_dr"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">TL;DR</fo:marker><fo:block font-size="24.8832pt">5.1. TL;DR</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">For the purposes of this tutorial, we have specially prepared an
example application for you to follow along with. The application
uses a bucket with one of the sample datasets which come with Couchbase
Server itself: <fo:inline font-size="10pt" font-family="LiberationMono">beer-sample</fo:inline>. If you haven’t already, download the
latest Couchbase Server 2.0 release and install it. While following
the download instructions and setup wizard, make sure you install the
<fo:inline font-size="10pt" font-family="LiberationMono">beer-sample</fo:inline> default bucket. It contains a sample data set of beers and
breweries, which we’ll use in our examples here. If you’ve
already installed Couchbase Server 2.0 and didn’t install the
<fo:inline font-size="10pt" font-family="LiberationMono">beer-sample</fo:inline> bucket (or if you deleted it), just open the Web-UI and
navigate to "Settings/Sample Buckets".  Select the <fo:inline font-size="10pt" font-family="LiberationMono">beer-sample</fo:inline>
checkbox and click "Create". In the right hand corner you’ll see a
notification box that will disappear once the bucket is ready to be
used.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">After that you can clone the complete repository from couchbaselabs on github:</fo:block><fo:block id="idp5832496" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">shell&gt; git clone git://github.com/couchbaselabs/couchbase-beer.rb.git
Cloning into 'couchbase-beer.rb'...
remote: Counting objects: 409, done.
remote: Compressing objects: 100% (254/254), done.
remote: Total 409 (delta 183), reused 340 (delta 114)
Receiving objects: 100% (409/409), 235.17 KiB | 130 KiB/s, done.
Resolving deltas: 100% (183/183), done.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Navigate to the directory and install all application dependencies:</fo:block><fo:block id="idp5833936" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">shell&gt; cd couchbase-beer.rb/
shell&gt; bundle install
...snip...
Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">That’s it. Assuming that the server with <fo:inline font-size="10pt" font-family="LiberationMono">beer-sample</fo:inline> bucket is up
and running on localhost, you can just start ruby web server:</fo:block><fo:block id="idp5836192" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">shell&gt; rails server
=&gt; Booting Thin
=&gt; Rails 3.2.8 application starting in development on http://0.0.0.0:3000
=&gt; Call with -d to detach
=&gt; Ctrl-C to shutdown server
&gt;&gt; Thin web server (v1.5.0 codename Knife)
&gt;&gt; Maximum connections set to 1024
&gt;&gt; Listening on 0.0.0.0:3000, CTRL+C to stop</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Then navigate to <fo:basic-link external-destination="url(http://localhost:3000/)">http://localhost:3000/</fo:basic-link>. You should see something like that:</fo:block><fo:block id="idp5838416" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block id="idp5838912"><fo:external-graphic src="url(image/couchbase-beer.rb-home.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block><fo:block id="_create_application_skeleton"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Create Application Skeleton</fo:marker><fo:block font-size="24.8832pt">5.2. Create Application Skeleton</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">If you would like to learn how to create this application from scratch
just continue reading. As with any rails application we will use
generators a lot. Since we don’t need ActiveRecord we’ll let
<fo:inline font-size="10pt" font-family="LiberationMono">rails new</fo:inline> know about it.</fo:block><fo:block id="idp5843120" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">shell&gt; rails new couchbase-beer.rb -O --old-style-hash</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Now navigate to the project root and open up <fo:inline font-size="10pt" font-family="LiberationMono">Gemfile</fo:inline> in your
favorite editor. First, we need to add the Couchbase client libraries there:</fo:block><fo:block id="idp5845088" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">gem <fo:inline color="#0000FF">'couchbase'</fo:inline>
gem <fo:inline color="#0000FF">'couchbase-model'</fo:inline>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Skipping the version will get the latest stable versions of those gems. We
will use the <fo:basic-link external-destination="url(https://rubygems.org/gems/couchbase-model)">couchbase-model</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://rubygems.org/gems/couchbase-model)">https://rubygems.org/gems/couchbase-model</fo:basic-link>]</fo:inline>
gem to define our models in a declarative way much like all rails developers
describe their models with ActiveRecord. Apart from that we
will use <fo:inline font-size="10pt" font-family="LiberationMono">yajl-ruby</fo:inline>, a high-performance JSON parser/generator,
<fo:inline font-size="10pt" font-family="LiberationMono">rdiscount</fo:inline> to render descriptions as Markdown, and <fo:inline font-size="10pt" font-family="LiberationMono">omniauth-twitter</fo:inline>
for authentication.</fo:block><fo:block id="idp5849776" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">gem <fo:inline color="#0000FF">'yajl-ruby'</fo:inline>
gem <fo:inline color="#0000FF">'rdiscount'</fo:inline>
gem <fo:inline color="#0000FF">'omniauth-twitter'</fo:inline>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The complete <fo:inline font-size="10pt" font-family="LiberationMono">Gemfile</fo:inline> will looks like this:</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Gemfile. </fo:inline>
<fo:block id="idp5852640" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">source <fo:inline color="#0000FF">'https://rubygems.org'</fo:inline>

gem <fo:inline color="#0000FF">'rails'</fo:inline>, <fo:inline color="#0000FF">'3.2.8'</fo:inline>

gem <fo:inline color="#0000FF">"eventmachine"</fo:inline>, <fo:inline color="#0000FF">"~&gt; 1.0.0"</fo:inline>
gem <fo:inline color="#0000FF">'thin'</fo:inline>, <fo:inline color="#0000FF">"~&gt; 1.5.0"</fo:inline>
gem <fo:inline color="#0000FF">'jquery-rails'</fo:inline>
gem <fo:inline color="#0000FF">'yajl-ruby'</fo:inline>
gem <fo:inline color="#0000FF">'couchbase'</fo:inline>
gem <fo:inline color="#0000FF">'couchbase-model'</fo:inline>
gem <fo:inline color="#0000FF">'rdiscount'</fo:inline>
gem <fo:inline color="#0000FF">'omniauth'</fo:inline>
gem <fo:inline color="#0000FF">'omniauth-twitter'</fo:inline>

gem <fo:inline color="#0000FF">'capistrano'</fo:inline>

group <fo:inline color="#0000FF">:development</fo:inline>, <fo:inline color="#0000FF">:test</fo:inline> <fo:inline font-weight="bold" color="#000080">do</fo:inline>
  gem <fo:inline color="#0000FF">'debugger'</fo:inline>
<fo:inline font-weight="bold" color="#000080">end</fo:inline>

group <fo:inline color="#0000FF">:assets</fo:inline> <fo:inline font-weight="bold" color="#000080">do</fo:inline>
  gem <fo:inline color="#0000FF">'sass-rails'</fo:inline>, <fo:inline color="#0000FF">'~&gt; 3.2.3'</fo:inline>
  gem <fo:inline color="#0000FF">'uglifier'</fo:inline>, <fo:inline color="#0000FF">'&gt;= 1.0.3'</fo:inline>
<fo:inline font-weight="bold" color="#000080">end</fo:inline>
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Next step will be to configure Couchbase connection, this step should
be familiar to the rails developer, because <fo:inline font-size="10pt" font-family="LiberationMono">couchbase-model</fo:inline> brings
YAML-styled configuration, so if you know how
<fo:inline font-size="10pt" font-family="LiberationMono">config/database.yml</fo:inline> works, you can make some assumtions about how
<fo:inline font-size="10pt" font-family="LiberationMono">config/couchbase.yml</fo:inline> works. To generate a config, use the <fo:inline font-size="10pt" font-family="LiberationMono">couchbase:config</fo:inline>
generator:</fo:block><fo:block id="idp5857648" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">shell&gt; rails generate couchbase:config
      create  config/couchbase.yml</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Since our bucket name differs from the project name, you should update
the <fo:inline font-size="10pt" font-family="LiberationMono">bucket</fo:inline> property in the config. Also if your Couchbase Server is
not running on the local machine, you should also change the hostname
in the config. After you’ve made your modifications, your config should look like this:</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">config/couchbase.yml. </fo:inline>
<fo:block id="idp5860464" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">common: &amp;common
  hostname: localhost
  port: 8091
  username:
  password:
  pool: default

development:
  &lt;&lt;: *common
  bucket: beer-sample

production:
  &lt;&lt;: *common
  bucket: beer-sample</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">That’s it for configuration, let’s move forward and create some
models.</fo:block></fo:block><fo:block id="_define_models"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Define Models</fo:marker><fo:block font-size="24.8832pt">5.3. Define Models</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">To create a model, all you need is just define class and inherit from
<fo:inline font-size="10pt" font-family="LiberationMono">Couchbase::Model</fo:inline>. Lets dissect the <fo:inline font-size="10pt" font-family="LiberationMono">Brewery</fo:inline> model from the application.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">app/models/brewery.rb. </fo:inline>
<fo:block id="idp5865344" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0"><fo:inline font-weight="bold" color="#000080">class</fo:inline> Brewery &lt; Couchbase::Model
  attribute <fo:inline color="#0000FF">:name</fo:inline>, <fo:inline color="#0000FF">:description</fo:inline>
  attribute <fo:inline color="#0000FF">:country</fo:inline>, <fo:inline color="#0000FF">:state</fo:inline>, <fo:inline color="#0000FF">:city</fo:inline>, <fo:inline color="#0000FF">:address</fo:inline>
  attribute <fo:inline color="#0000FF">:phone</fo:inline>
  attribute <fo:inline color="#0000FF">:geo</fo:inline>
  attribute <fo:inline color="#0000FF">:updated</fo:inline>

  view <fo:inline color="#0000FF">:all</fo:inline>, <fo:inline color="#0000FF">:limit</fo:inline> =&gt; <fo:inline color="#0000FF">31</fo:inline>
  view <fo:inline color="#0000FF">:all_with_beers</fo:inline>
  view <fo:inline color="#0000FF">:by_country</fo:inline>, <fo:inline color="#0000FF">:include_docs</fo:inline> =&gt; <fo:inline font-weight="bold" color="#000080">false</fo:inline>, <fo:inline color="#0000FF">:group</fo:inline> =&gt; <fo:inline font-weight="bold" color="#000080">true</fo:inline>
  view <fo:inline color="#0000FF">:points</fo:inline>, <fo:inline color="#0000FF">:spatial</fo:inline> =&gt; <fo:inline font-weight="bold" color="#000080">true</fo:inline>

  <fo:inline font-weight="bold" color="#000080">def</fo:inline> full_address
    [country, state, city, address].reject(&amp;<fo:inline color="#0000FF">:blank?</fo:inline>).join(<fo:inline color="#0000FF">', '</fo:inline>)
  <fo:inline font-weight="bold" color="#000080">end</fo:inline>

  <fo:inline font-weight="bold" color="#000080">def</fo:inline> location
    [country, state].reject(&amp;<fo:inline color="#0000FF">:blank?</fo:inline>).join(<fo:inline color="#0000FF">', '</fo:inline>)
  <fo:inline font-weight="bold" color="#000080">end</fo:inline>
<fo:inline font-weight="bold" color="#000080">end</fo:inline>
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The first part of the model contains attribute definitions.  The <fo:inline font-size="10pt" font-family="LiberationMono">attribute</fo:inline>
macro defines a pair of accessors and helps to maintain map of
attributes-values. You can also specify default a value for each
attribute:</fo:block><fo:block id="idp5868720" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0"><fo:inline font-weight="bold" color="#000080">class</fo:inline> Post &lt; Couchbase::Model
  attribute <fo:inline color="#0000FF">:title</fo:inline>, <fo:inline color="#0000FF">:body</fo:inline>
  attribute <fo:inline color="#0000FF">:timestamp</fo:inline>, <fo:inline color="#0000FF">:default</fo:inline> =&gt; lambda{ Time.now }
<fo:inline font-weight="bold" color="#000080">end</fo:inline>

Post.new(<fo:inline color="#0000FF">:title</fo:inline> =&gt; <fo:inline color="#0000FF">"Hello, World!"</fo:inline>)
<fo:inline font-style="italic" color="#008800">#=&gt; #&lt;Post timestamp: 2012-12-07 16:03:56 +0300, title: "Hello, World!"&gt;</fo:inline>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The next block is about defining views. One way to play with views is
Couchbase Server Admin Console, but it may not be the best to keep parts
of the code in different places. After all Views are implemented in
Javascript and carry part of business logic. <fo:inline font-size="10pt" font-family="LiberationMono">couchbase-model</fo:inline> has
solution for it. Each time the server starts (in development mode
for each request), the application will check the filesystem changes
of the map/reduce javascript files and update design document if
needed. There is also the rails generator for views. It will put
view stubs for you in proper places. Here, for example, is the model layout for
this particular application:</fo:block><fo:block id="idp5871936" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">app/models/
├── beer
│   ├── all
│   │   └── map.js
│   └── by_category
│       ├── map.js
│       └── reduce.js
├── beer.rb
├── brewery
│   ├── all
│   │   └── map.js
│   ├── all_with_beers
│   │   └── map.js
│   ├── by_country
│   │   ├── map.js
│   │   └── reduce.js
│   └── points
│       └── spatial.js
├── brewery.rb
├── favorites.rb
└── user.rb</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">For each model which has views,
you should create a directory with the same name and put in the appropriate
javascript files. Each should implement the corresponding parts of
the view. For example <fo:inline font-size="10pt" font-family="LiberationMono">_design/brewery/_view/by_country</fo:inline> does require both
map and reduce parts. To generate a new view you should pass model name
and view name you need to get:</fo:block><fo:block id="idp5874624" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">shell&gt; rails generate couchbase:view beer test
      create  app/models/beer/test/map.js
      create  app/models/beer/test/reduce.js</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Those automatically generated files are full of comments, so they
are worth reading as quick start about how to write View indexes.  The offical
documentation for how to do so is in the Couchbase Server manual.</fo:block></fo:block><fo:block id="_implement_controllers"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Implement Controllers</fo:marker><fo:block font-size="24.8832pt">5.4. Implement Controllers</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Now lets dissect the controllers from the project. This is where data is
selected to display to user. For example <fo:inline font-size="10pt" font-family="LiberationMono">BreweriesController</fo:inline>:</fo:block><fo:block id="idp5878512" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0"><fo:inline font-weight="bold" color="#000080">class</fo:inline> BreweriesController &lt; ApplicationController
  <fo:inline font-weight="bold" color="#000080">def</fo:inline> index
    filter = params.extract!(<fo:inline color="#0000FF">:start_key</fo:inline>, <fo:inline color="#0000FF">:end_key</fo:inline>).reject{|_, v| v.blank?}
    @breweries = Brewery.all(filter).to_a
    <fo:inline font-weight="bold" color="#000080">if</fo:inline> @breweries.size &gt; <fo:inline color="#0000FF">30</fo:inline>
      @last_key = @breweries.pop.try(<fo:inline color="#0000FF">:key</fo:inline>)
    <fo:inline font-weight="bold" color="#000080">end</fo:inline>
    respond_to <fo:inline font-weight="bold" color="#000080">do</fo:inline> |format|
      format.html
      format.json <fo:inline font-weight="bold" color="#000080">do</fo:inline>
        render <fo:inline color="#0000FF">:json</fo:inline> =&gt; {<fo:inline color="#0000FF">:last_key</fo:inline> =&gt; @last_key, <fo:inline color="#0000FF">:items</fo:inline> =&gt; @breweries}
      <fo:inline font-weight="bold" color="#000080">end</fo:inline>
    <fo:inline font-weight="bold" color="#000080">end</fo:inline>
  <fo:inline font-weight="bold" color="#000080">end</fo:inline>

  <fo:inline font-weight="bold" color="#000080">def</fo:inline> show
    @brewery, *@beers = Brewery.all_with_beers(<fo:inline color="#0000FF">:start_key</fo:inline> =&gt; [params[<fo:inline color="#0000FF">:id</fo:inline>]],
                                               <fo:inline color="#0000FF">:end_key</fo:inline> =&gt; [<fo:inline color="#0000FF">"</fo:inline><fo:inline color="#0000FF">#{</fo:inline>params[<fo:inline color="#0000FF">:id</fo:inline>]<fo:inline color="#0000FF">}</fo:inline><fo:inline color="#0000FF">\uefff"</fo:inline>]).to_a
  <fo:inline font-weight="bold" color="#000080">end</fo:inline>
<fo:inline font-weight="bold" color="#000080">end</fo:inline>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">It has two actions:</fo:block><fo:list-block id="idp5880672" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idp5881648" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
"index" which is supposed to pull the list of breweries. It might look
  complex, but it isn’t. In first line we are preparing query
  parameters for views. In particular, we are interested in the <fo:inline font-size="10pt" font-family="LiberationMono">start_key</fo:inline>
  and <fo:inline font-size="10pt" font-family="LiberationMono">end_key</fo:inline> parameters, but we need them only if they aren’t blank
  (i.e. not nil and not empty string). The second step is to execute
  the view and get results immediately. Your application might want to
  fetch the entries from view on demand in a lazy manner, then you no
  need to call the <fo:inline font-size="10pt" font-family="LiberationMono">#to_a</fo:inline> method and iterate over them or call methods
  like <fo:inline font-size="10pt" font-family="LiberationMono">#next</fo:inline>. In this particular example we are fetching 31 records
  and are trying to pop last one to use it later for "infinite"
  scrolling. The end of the method is responsible for rendering
  the data in two formats, by default it will use HTML, but if the application is responding to
  an AJAX request with the <fo:inline font-size="10pt" font-family="LiberationMono">Accept: application/json</fo:inline> header, it will instead
  render the JSON representation of our models.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idp5887392" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
"show" uses another view from the <fo:inline font-size="10pt" font-family="LiberationMono">Brewery</fo:inline> model, which
  collates breweries with beer for easier access. Here is a map function
  which does that job:
</fo:block><fo:block id="idp5888848" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">function(doc, meta) {
  switch(doc.type) {
  case "brewery":
    emit([meta.id]);
    break;
  case "beer":
    if (doc.brewery_id &amp;&amp; doc.name) {
      emit([doc.brewery_id, doc.name]);
    }
    break;
  }
}</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">As you can see we are using a compound key with brewery ID in the
first position and the document name in the second position. Because we are selecting
only beers without null names, they will be sorted after the
breweries. By doing so, when we filter result by the first key only, the
<fo:inline font-size="10pt" font-family="LiberationMono">@brewery</fo:inline> variable will receive first element of the sequence, and
<fo:inline font-size="10pt" font-family="LiberationMono">@beers</fo:inline> will get the rest of the collection because of the splat (<fo:inline font-size="10pt" font-family="LiberationMono">*</fo:inline>)
operator.</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block><fo:block id="_bonus_spatial_queries_sessions_and_cache"><fo:block><fo:block><fo:block margin-left="0pt" font-family="URW Bookman L,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="URW Bookman L" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Bonus: Spatial Queries, Sessions and Cache</fo:marker><fo:block font-size="24.8832pt">5.5. Bonus: Spatial Queries, Sessions and Cache</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">One of the experimental features of the Couchbase Server is spatial
views. These kind of views allow you to build indexes on geo
attributes of your data. Sample application has part, demostrating
power of spatial views. Click on the "Map" link in the menu, and if
you allowed your browser to fetch your current location it will
position the center of the map to your, or to Mountain View otherwise.
After that it will execute spatial query using map bounds and the
Couchbase Server will give you all the breweries which are nearby.
Lets take a look at the implemetation. The core of this feature in
<fo:inline font-size="10pt" font-family="LiberationMono">brewery/points/spatial.js</fo:inline>:</fo:block><fo:block id="idp5895552" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">function(doc, meta) {
  if (doc.geo &amp;&amp; doc.geo.lng &amp;&amp; doc.geo.lat &amp;&amp; doc.name) {
    emit({type: "Point", coordinates: [doc.geo.lng, doc.geo.lat]},
         {name: doc.name, geo: doc.geo});
  }
}</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The function will emit Point object and the name with coordinates as
the payload. The action in the controller is quite trivial, it
transmit the result to the frontend in JSON representation, where
google maps is rendering markers for each object.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Except nice extensions, provided by <fo:inline font-size="10pt" font-family="LiberationMono">couchbase-model</fo:inline> library,
<fo:inline font-size="10pt" font-family="LiberationMono">couchase</fo:inline> gem itself has few more nice features which could be useful
in the web application. For example, you can easily substitute your
session or cache store in rails (or even in rack) with Couchbase
Server.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">To use Couchbase as cache store in rails, just put following line in
your <fo:inline font-size="10pt" font-family="LiberationMono">config/application.rb</fo:inline> file:</fo:block><fo:block id="idp5900352" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">config.cache_store = <fo:inline color="#0000FF">:couchbase_store</fo:inline>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">You can also pass additional connection options there</fo:block><fo:block id="idp5901840" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">cache_options = {
  <fo:inline color="#0000FF">:bucket</fo:inline> =&gt; <fo:inline color="#0000FF">'protected'</fo:inline>,
  <fo:inline color="#0000FF">:username</fo:inline> =&gt; <fo:inline color="#0000FF">'protected'</fo:inline>,
  <fo:inline color="#0000FF">:password</fo:inline> =&gt; <fo:inline color="#0000FF">'secret'</fo:inline>,
  <fo:inline color="#0000FF">:expires_in</fo:inline> =&gt; <fo:inline color="#0000FF">30</fo:inline>.seconds
}
config.cache_store = <fo:inline color="#0000FF">:couchbase_store</fo:inline>, cache_options
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">To use Couchbase as the session store you should update your
<fo:inline font-size="10pt" font-family="LiberationMono">config/initializers/session_store.rb</fo:inline> file</fo:block><fo:block id="idp5904304" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">require <fo:inline color="#0000FF">'action_dispatch/middleware/session/couchbase_store'</fo:inline>
AppName::Application.config.session_store <fo:inline color="#0000FF">:couchbase_store</fo:inline>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Or remove this file and add following line to your <fo:inline font-size="10pt" font-family="LiberationMono">config/application.rb</fo:inline>:</fo:block><fo:block id="idp5906704" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">require <fo:inline color="#0000FF">'action_dispatch/middleware/session/couchbase_store'</fo:inline>
config.session_store <fo:inline color="#0000FF">:couchbase_store</fo:inline>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">You can also pass additional options:</fo:block><fo:block id="idp5908432" keep-together.within-column="auto" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-size="10pt" font-family="LiberationMono" background-color="#F9F9F9" border-width="0.5pt" border-style="solid" border-color="#a7a7a7" padding="3pt" border="0">require <fo:inline color="#0000FF">'action_dispatch/middleware/session/couchbase_store'</fo:inline>
session_options = {
  <fo:inline color="#0000FF">:expire_after</fo:inline> =&gt; <fo:inline color="#0000FF">5</fo:inline>.minutes,
  <fo:inline color="#0000FF">:couchbase</fo:inline> =&gt; {<fo:inline color="#0000FF">:bucket</fo:inline> =&gt; <fo:inline color="#0000FF">"sessions"</fo:inline>, <fo:inline color="#0000FF">:default_format</fo:inline> =&gt; <fo:inline color="#0000FF">:json</fo:inline>}
}
config.session_store <fo:inline color="#0000FF">:couchbase_store</fo:inline>, session_options
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">In the example above we are specifying format as JSON which allows us
to share sessions in heterogenous environment, and also analyze them
using Map/Reduce. But keep in the mind that not everything in typical
rails application could be serialized to JSON, for example
<fo:inline font-size="10pt" font-family="LiberationMono">ActionDispatch::Flash::FlashHash</fo:inline>. This is why the library serialize
sessions using <fo:inline font-size="10pt" font-family="LiberationMono">Marshal.dump</fo:inline> by default.</fo:block></fo:block></fo:flow></fo:page-sequence></fo:root>
